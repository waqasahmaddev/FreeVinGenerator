let allowedChars="ABCDEFGHJKLMNPRSTUVWXYZ0123456789";function transliterate(e){return{A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9}[e]||0}let weights=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2];function calculateCheckDigit(t){let n=0;for(let e=0;e<17;e++)n+=transliterate(t[e])*weights[e];var e=n%11;return 10===e?"X":e.toString()}function generateVIN(){var t=[];for(let e=0;e<17;e++)t.push(allowedChars[Math.floor(Math.random()*allowedChars.length)]);t[8]=calculateCheckDigit(t);var e=t.join(""),n=document.getElementById("vin");n&&(n.value=e)}function copyVIN(){var t=document.getElementById("vin");if(t){t.select(),t.setSelectionRange(0,99999),navigator.clipboard.writeText(t.value);let e=document.getElementById("notification");e&&(e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},2500))}}function toggleTheme(){var e=document.documentElement,t=document.body,e=e.classList.toggle("dark-mode");t.classList.toggle("dark-mode"),localStorage.setItem("theme",e?"dark":"light")}function loadTheme(){"dark"===localStorage.getItem("theme")&&document.body.classList.add("dark-mode")}function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function handleScroll(){var e=document.querySelector(".scroll-to-top");e&&(300<window.pageYOffset?e.classList.add("visible"):e.classList.remove("visible"))}function toggleMobileMenu(){var e=document.getElementById("mainNav"),t=document.querySelector(".mobile-menu-toggle"),n=document.body;e.classList.toggle("active"),t.classList.toggle("active"),n.classList.toggle("menu-open")}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("currentYear"),e=(e&&(e.textContent=(new Date).getFullYear()),document.getElementById("vin")),e=(e&&generateVIN(),localStorage.getItem("theme"));"dark"===e&&document.body.classList.add("dark-mode"),window.addEventListener("scroll",handleScroll)}),document.addEventListener("click",function(e){var t,n=document.getElementById("mainNav"),a=document.querySelector(".mobile-menu-toggle"),o=document.body,l=document.getElementById("menuOverlay");n&&a&&n.classList.contains("active")&&(t=n.contains(e.target),e=a.contains(e.target),t||e||(n.classList.remove("active"),a.classList.remove("active"),o.classList.remove("menu-open"),l&&l.classList.remove("active")))}),document.addEventListener("DOMContentLoaded",function(){let a=document.getElementById("menuOverlay");a&&a.addEventListener("click",function(){var e=document.getElementById("mainNav"),t=document.querySelector(".mobile-menu-toggle"),n=document.body;e&&t&&(e.classList.remove("active"),t.classList.remove("active"),n.classList.remove("menu-open"),a.classList.remove("active"))});var e=document.querySelectorAll("#mainNav a");let o=document.body;e.forEach(e=>{e.addEventListener("click",function(){var e=document.getElementById("mainNav"),t=document.querySelector(".mobile-menu-toggle"),n=document.getElementById("menuOverlay");e&&t&&e.classList.contains("active")&&(e.classList.remove("active"),t.classList.remove("active"),o.classList.remove("menu-open"),n)&&n.classList.remove("active")})})});let allowedCharsBulk="ABCDEFGHJKLMNPRSTUVWXYZ0123456789",generatedVINs=[];function transliterateBulk(e){return{A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9}[e]||0}function calculateCheckDigitBulk(t){var n=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2];let a=0;for(let e=0;e<17;e++)a+=transliterateBulk(t[e])*n[e];var e=a%11;return 10===e?"X":e.toString()}function generateSingleVIN(){var t=[];for(let e=0;e<17;e++)t.push(allowedCharsBulk[Math.floor(Math.random()*allowedCharsBulk.length)]);return t[8]=calculateCheckDigitBulk(t),t.join("")}function generateBulkVINs(){var e=document.getElementById("vinCount");let t=parseInt(e.value);isNaN(t)||t<1?(t=1,e.value=1):1e3<t&&(t=1e3,e.value=1e3),generatedVINs=[];for(let e=0;e<t;e++)generatedVINs.push(generateSingleVIN());document.getElementById("vinsOutput").value=generatedVINs.join("\n"),document.getElementById("bulkOutput").style.display="block",document.getElementById("copyBtn").style.display="flex",document.getElementById("downloadBtns").style.display="flex",showNotification(`Generated ${t} VIN${1<t?"s":""} successfully!`)}function copyAllVINs(){var e=document.getElementById("vinsOutput");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value),showNotification("All VINs copied to clipboard!")}function downloadVINs(e){let t="",n="",a="";"txt"===e?(t=generatedVINs.join("\n"),n="vins.txt",a="text/plain"):"csv"===e&&(t="VIN\n"+generatedVINs.join("\n"),n="vins.csv",a="text/csv");var e=new Blob([t],{type:a}),e=window.URL.createObjectURL(e),o=document.createElement("a");o.href=e,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(e),showNotification(`Downloaded as ${n}!`)}function showNotification(e){let t=document.getElementById("notification");t.textContent=e,t.classList.add("show"),setTimeout(()=>{t.classList.remove("show")},2500)}let countryMap={1:"United States",4:"United States",5:"United States",2:"Canada",3:"Mexico",J:"Japan",K:"South Korea",L:"China",S:"United Kingdom",V:"France/Spain",W:"Germany",Y:"Sweden/Finland",Z:"Italy"},manufacturerMap={"1F":"Ford","1G":"General Motors","1H":"Honda","1N":"Nissan","1C":"Chrysler","1L":"Lincoln","1M":"Mercury","2F":"Ford Canada","2G":"General Motors Canada","2H":"Honda Canada","3F":"Ford Mexico","3G":"General Motors Mexico","3H":"Honda Mexico",JH:"Honda Japan",JT:"Toyota",JN:"Nissan Japan",JM:"Mazda",KM:"Hyundai",KN:"Kia",WA:"Audi",WB:"BMW",WV:"Volkswagen",WP:"Porsche",WD:"Mercedes-Benz",YV:"Volvo",ZA:"Fiat",ZF:"Ferrari",ZL:"Lamborghini"},yearMap={A:1980,A:2010,B:1981,B:2011,C:1982,C:2012,D:1983,D:2013,E:1984,E:2014,F:1985,F:2015,G:1986,G:2016,H:1987,H:2017,J:1988,J:2018,K:1989,K:2019,L:1990,L:2020,M:1991,M:2021,N:1992,N:2022,P:1993,P:2023,R:1994,R:2024,S:1995,S:2025,T:1996,V:1997,W:1998,X:1999,Y:2e3,1:2001,2:2002,3:2003,4:2004,5:2005,6:2006,7:2007,8:2008,9:2009};function transliterateChar(e){return{A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9}[e]||0}function validateCheckDigit(t){var n=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2];let a=0;for(let e=0;e<17;e++)a+=transliterateChar(t[e])*n[e];var e=a%11;return(10===e?"X":e.toString())===t[8]}function getCountry(e){e=e[0];return countryMap[e]||"Unknown"}function getManufacturer(e){e=e.substring(0,2);return manufacturerMap[e]||"Unknown"}function getModelYear(e){e=e[9];return yearMap[e]&&yearMap[e]<=2009?yearMap[e]:"A"<=e&&e<="Y"?2010+(e.charCodeAt(0)-"A".charCodeAt(0)):"1"<=e&&e<="9"?2001+parseInt(e)-1:"Unknown"}function decodeVIN(){var e,t,n,a,o,l,c=document.getElementById("vinInput").value.toUpperCase().trim();17===c.length&&/^[A-HJ-NPR-Z0-9]{17}$/.test(c)?(e=validateCheckDigit(c),t=getCountry(c),n=getManufacturer(c),a=getModelYear(c),o=c[10],l=c.substring(11,17),document.getElementById("decodedVin").textContent=c,document.getElementById("checkDigitStatus").textContent=e?"✓ Valid":"✗ Invalid",document.getElementById("checkDigitStatus").style.color=e?"#38ef7d":"#f45c43",document.getElementById("country").textContent=t,document.getElementById("manufacturer").textContent=n,document.getElementById("modelYear").textContent=a,document.getElementById("plantCode").textContent=o,document.getElementById("serialNumber").textContent=l,document.getElementById("decodeResult").style.display="block"):document.getElementById("decodeResult").style.display="none"}function clearDecoder(){document.getElementById("vinInput").value="",document.getElementById("decodeResult").style.display="none"}function transliterateCharValidator(e){return{A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,J:1,K:2,L:3,M:4,N:5,P:7,R:9,S:2,T:3,U:4,V:5,W:6,X:7,Y:8,Z:9,0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9}[e]||0}function calculateExpectedCheckDigit(t){var n=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2];let a=0;for(let e=0;e<17;e++)a+=transliterateCharValidator(t[e])*n[e];var e=a%11;return 10===e?"X":e.toString()}function validateVIN(){var t=document.getElementById("vinValidateInput").value.toUpperCase().trim(),n=document.getElementById("validationResult"),a=document.getElementById("validationDetails");if(n.innerHTML="",0===t.length)a.style.display="none";else{let e=!0;var o=[],l=17===t.length,c=(document.getElementById("lengthCheck").textContent=l?"✓ Valid (17 characters)":"✗ Invalid (must be 17 characters)",document.getElementById("lengthCheck").style.color=l?"#38ef7d":"#f45c43",l||(e=!1,o.push("VIN must be exactly 17 characters")),/^[A-HJ-NPR-Z0-9]*$/.test(t));document.getElementById("characterCheck").textContent=c?"✓ Valid characters":"✗ Invalid characters (I, O, Q not allowed)",document.getElementById("characterCheck").style.color=c?"#38ef7d":"#f45c43",c||(e=!1,o.push("VIN contains invalid characters (I, O, Q are not allowed)"));l&&c?(t=(l=calculateExpectedCheckDigit(t))===(c=t[8]),document.getElementById("checkDigitCheck").textContent=t?"✓ Valid":"✗ Invalid",document.getElementById("checkDigitCheck").style.color=t?"#38ef7d":"#f45c43",document.getElementById("expectedCheckDigit").textContent=l,document.getElementById("actualCheckDigit").textContent=c,t||(e=!1,o.push(`Check digit mismatch (expected ${l}, got ${c})`))):(document.getElementById("checkDigitCheck").textContent="N/A",document.getElementById("checkDigitCheck").style.color="#718096",document.getElementById("expectedCheckDigit").textContent="N/A",document.getElementById("actualCheckDigit").textContent="N/A"),e?n.innerHTML='<div class="validation-result valid">✓ Valid VIN</div>':(t='<div class="validation-result invalid">✗ Invalid VIN<br><br>'+o.join("<br>")+"</div>",n.innerHTML=t),a.style.display="block"}}function clearValidator(){document.getElementById("vinValidateInput").value="",document.getElementById("validationResult").innerHTML="",document.getElementById("validationDetails").style.display="none"}